{% extends "base.html" %}
{% block meta_title %}{% endblock %}
{% block title %}{% endblock %}
{% block breadcrumb_menu %}

    {{ block.super }}
    Dev Playground

{% endblock %}

{% block all_content %}

<style>

    canvas {
{#        border: 1px solid black;#}
{#        background-image: url("/static/img/sw-final.png");#}
{#        background-repeat: no-repeat;#}
    }

</style>

<div id="mouse_report"></div>

<div class="row" style="margin-top: 30px; height: 900px;">
    <div class="col-xs-12 text-center">
        <img src="/static/img/sw-final.png" height=870px>
    </div>
</div>

<div class="row" style="position: relative; top: -900px; left: 12px;">
    <div class="col-xs-12 text-center">
        <canvas id="pie_canvas" width="900" height="900">
            Your browser does not support HTML5 Canvas.
        </canvas>
    </div>
</div>

<script>

    var C = document.getElementById('pie_canvas');
    var wedges = ['none', 'conflict', 'character', 'theme', 'world', 'plot'];
    var paths = [];

    if (C.getContext) {
        var ctx = C.getContext('2d');
        var path1 = new Path2D(),
            path2 = new Path2D(),
            path3 = new Path2D(),
            path4 = new Path2D(),
            path5 = new Path2D();

        ctx.lineWidth = .01;

        {
            // pie/conflict
            path1.moveTo(20.0, 300.7);
            path1.bezierCurveTo(83.7, 121.7, 250.3, 7.0, 431.1, 1.8);
            path1.lineTo(431.1, 434.1);
            path1.lineTo(430.9, 434.1);
            path1.lineTo(20.0, 300.6);
            path1.closePath();
            ctx.stroke(path1);
            paths.push(path1);


            // pie/character
            path2.moveTo(847.4, 304.3);
            path2.bezierCurveTo(901.1, 486.5, 833.7, 677.2, 690.5, 787.7);
            path2.lineTo(436.4, 437.9);
            path2.lineTo(436.5, 437.9);
            path2.lineTo(847.4, 304.4);
            path2.closePath();
            ctx.stroke(path2);
            paths.push(path2);

            // pie/theme
            path3.moveTo(688.7, 789.6);
            path3.bezierCurveTo(532.0, 896.9, 329.8, 891.8, 180.5, 789.7);
            path3.lineTo(434.6, 440.0);
            path3.lineTo(434.7, 440.1);
            path3.lineTo(688.6, 789.6);
            path3.closePath();
            ctx.stroke(path3);
            paths.push(path3);

            // pie/world
            path4.moveTo(177.1, 787.9);
            path4.bezierCurveTo(26.6, 672.0, -31.0, 478.1, 19.9, 304.6);
            path4.lineTo(431.1, 438.2);
            path4.lineTo(431.0, 438.3);
            path4.lineTo(177.0, 787.8);
            path4.closePath();
            ctx.stroke(path4);
            paths.push(path4);

            // pie/plot
            path5.moveTo(434.6, 2.7);
            path5.bezierCurveTo(624.6, 7.9, 785.1, 130.9, 845.9, 301.2);
            path5.lineTo(434.8, 434.8);
            path5.lineTo(434.8, 434.7);
            path5.lineTo(434.8, 2.7);
            path5.lineTo(434.6, 2.7);
            path5.closePath();
            ctx.stroke(path5);
            paths.push(path5);
        }

    } else {
        // canvas-unsupported code here
    }

    C.addEventListener('click', function(e) {
        var segment = 0;
        var mousePos = getMousePos(C, e);
        var message = 'Mouse position: ' + mousePos.x + ',' + mousePos.y;
        console.log(' ');
        for (i = 0; i < 5; i++) {
            console.log(i + ' - ' + ctx.isPointInPath(paths[i], mousePos.x, mousePos.y));
            if (ctx.isPointInPath(paths[i], mousePos.x, mousePos.y)) {
                segment = i+1;
                break
            }
        }
        if (segment > 0) {
            alert(wedges[segment] + ' clicked');
        }
    });

    function getMousePos(canvas, evt) {
        var rect = canvas.getBoundingClientRect();
        return {
            x: evt.clientX - rect.left,
            y: evt.clientY - rect.top
        };
    }

    function getRandomColor() {
        var letters = '0123456789ABCDEF';
        var color = '#';
        for (var i = 0; i < 6; i++) {
            color += letters[Math.floor(Math.random() * 16)];
        }
        return color;
    }

</script>

{% endblock all_content %}
