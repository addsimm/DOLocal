{% extends "josstaff/staff_base.html" %}
{% load i18n tz pages_tags mezzanine_tags staticfiles %}

{% block outer_breadcrumb %}{% endblock outer_breadcrumb %}

{% block all_content %}



    <style>

        .container {
            margin-top: 0;
        }

        .videoContainer {
            border: 7px solid rgb(65, 45, 120);
            height: 160px;
            margin: 0;
            padding: 0;
            width: 240px;
            background-color: pink;
        }

        .nameContainer {
            color: green;
            font-family: "Open Sans", sans-serif;
            font-size: 18pt;
            margin: 0;
            padding: 10px;
            width: 240px;
        }

        .bckgrndimg {

        }

    </style>

    {# <span class="josinstructions">Facilitator:</span> #}




    <div class="row josinstructions" style="margin-top: -50px;">

        <div id="audienceContainer" class="col-xs-12" style="background-color: transparent; padding: 15px 25px;">

            <video id="myvideo" style="transform: rotateY(-180deg);" autoplay muted></video>

        </div>

    </div>


    {# scripts #}
    <script src="https://cdn.temasys.com.sg/skylink/skylinkjs/0.6.x/skylink.complete.min.js"></script>

    <script charset="utf-8">

        var SkylinkDemo = new Skylink();

        SkylinkDemo.on('peerJoined', function (peerId, peerInfo, isSelf) {
            console.log('peerJoined Id: ' + peerId);

            if (isSelf) return; // self - video element already created above

            // create element for peer video:
            var vid = document.createElement('video');
            vid.autoplay = true;
            vid.muted = true; // Added to avoid feedback when testing locally
            vid.id = peerId;
            document.body.appendChild(vid);
        });

        SkylinkDemo.on('incomingStream', function (peerId, stream, isSelf) {
            console.log('incomingStream Id: ' + peerId);
            if (isSelf) return;
            var vid = document.getElementById(peerId);
            // attach media stream
            attachMediaStream(vid, stream);
        });

        SkylinkDemo.on('peerLeft', function (peerId, peerInfo, isSelf) {
            console.log('peerLeft Id: ' + peerId);
            var vid = document.getElementById(peerId);
            document.body.removeChild(vid);
        });

        SkylinkDemo.on('mediaAccessSuccess', function (stream) {
            console.log('mediaAccessSuccess: ' + stream);
            var vid = document.getElementById('myvideo');
            attachMediaStream(vid, stream);
        });

        SkylinkDemo.on("readyStateChange", function (state, room) {
            console.log("Room (" + room + ") state: ", room);
        });

        // always remember to call init() - HIDE API KEY
        SkylinkDemo.init({
            appKey: "441543cd-a1c5-4d93-a25c-3339daa9b959",
            defaultRoom: "defaultroom"                     // ENCRYPT ROOM NAME
            },
            function (error, success) {
            console.log('init: ' + success);

            // do a check for error or success
            if (error) {
                console.error("Init failed error: ", error);
            } else {
                console.log('joinRoom init');
                SkylinkDemo.joinRoom({
                    userData: '{{ request.user.username }}',
                    video: true,
                    audio: true,
                    audioFallback: true,
                    height: 160,
                    width: 240,
                    frameRate: 15
                });
            }
        });



    </script>

{% endblock all_content %}


