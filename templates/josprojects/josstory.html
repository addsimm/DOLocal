{% extends "base.html" %}
{% load i18n mezzanine_tags accounts_tags  %}

{% block meta_title %}
    {{ story.title | striptags | truncatechars:25 }}
{% endblock %}
{% block title %}
    {{ story.title | striptags | truncatechars:25 }}
{% endblock %}

{% block breadcrumb_menu %}

    {{ block.super }}
    <span style="font-size: 16pt; font-weight: normal">Story:</span>
    {{ story.title  | striptags | truncatechars:25 }}
    </div></div>

{% endblock %}

{% block all_content %}

    <style>

        p {
            margin: 0;
        }

        .fixed {
            height: 600px;
            overflow: hidden;
        }

        .scrollit {
            height: 900px;
            overflow-y: scroll;
        }

    </style>


    <div class="row" style="margin-top: 50px;">

        <!-- Center Panel -->
        <div class="col-xs-10 scrollit" style=" ">

            <!-- Title -->
            <div class="row" style=" ">

                <div class="col-xs-12">

                    <div style="{% if edit %}border: 3px dashed #28a4c9;{% endif %}">
                        <div class="row" style="height:40px;">
                            <div class="col-xs-12">
                                <!-- Edit Button -->
                                {% if edit %}
                                    <a
                                       class="start_editor_button btn btn-info btn-xs pull-right"
                                       style="width: 80px"
                                       onclick="startCKEdit()"
                                       {# href="{% url "josstory_edit" story.id %}/?field_to_edit=title" #}
                                    >
                                        <i class="fa fa-pencil"></i>
                                        <span style="font-size: 14pt; margin-left: 3px;">Edit</span>
                                    </a>
                                {% endif %}
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-xs-12 homehead text-center">
                                {{ story.title | striptags }}<br>
                            </div>
                        </div>
                    </div>

                    <div class="joscursive text-center">
                        {{ story.author.JOSProfile.jos_name }}<br>
                    </div>
                </div>
            </div>

            <!-- Content -->
            <div class="row" style=" ">

                <div class="col-xs-12">

                    <div style="{% if edit %}border: 3px dashed #28a4c9;{% endif %}">
                        <div class="row" style="height:40px;">
                            <div class="col-xs-12">
                                <!-- Edit Button -->
                                {% if edit %}
                                    <a class="start_editor_button btn btn-info btn-xs pull-right"
                                       style="width: 80px"
                                       href="{% url "josstory_edit" story.id %}/?field_to_edit=content">
                                        <i class="fa fa-pencil"></i>
                                        <span style="font-size: 14pt; margin-left: 3px;">Edit</span>
                                    </a>
                                {% endif %}
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-xs-12" style="padding: 0 25px;">
                                <div id='editor1' contenteditable="false">

                                    {{ story.content | richtext_filters | safe }}

                                </div>
                            </div>
                        </div>

                        <div class="row" style="height:30px;">
                            <div class="col-xs-12">
                                <!-- Edit Button -->
                                {% if edit %}
                                    <a class="btn btn-info btn-xs pull-right"
                                       style="width: 80px"
                                       href="{% url "josstory_edit" story.id %}/?field_to_edit=content">
                                        <i class="fa fa-pencil"></i>
                                        <span style="font-size: 14pt; margin-left: 3px;">Edit</span>
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Side Panel -->
        <div class="col-xs-2 fixed" style=" ">

            <div style="font-size: 10pt; margin-bottom: 50px;">
                <i class="fa fa-arrow-left"></i> This column scrolls.
            </div>
            {% include "updated.html" with myobj=story %}<br>

            {% if story.author == request.user %}

                <a class="btn pull-right btn-info"
                   style="margin-top: 30px;"
                        {% if edit %}
                   href="{% url "josstory" story.id %}">
                            {% trans "Hide edit" %}
                        {% else %}
                            href="{% url "josstory_edit" story.id %}">
                            {% trans "Edit" %}
                        {% endif %}
                </a><br>

                <a class="btn pull-right {% if story.publish %}btn-danger{% else %}btn-success{% endif %}"
                   style="margin-top: 30px;"
                        {% if story.publish %}
                   href="{% url "josstory" story.id %}/?pub=remove">
                            {% trans "Hide" %}
                        {% else %}
                            href="{% url "josstory" story.id %}/?pub=publish">
                            {% trans "Publish" %}
                        {% endif %}
                </a><br>

                <a class="btn pull-right btn-warning"
                   style="margin-top: 30px;"
                   href="{% url "mystory_list" %}">
                    {% trans "My stories" %}
                </a>
            {% endif %}<br>

            <a class="btn pull-right btn-warning"
               style="margin-top: 30px;"
               href="{% url "story_gallery" %}">
                {% trans "Gallery" %}
            </a><br>

            {# comment #}
            <a class="btn pull-right btn-default"
               style="margin-top: 90px;"
               href="{% url "spirit:topic:publish" 3 %}">
                {% trans "Comment" %}
            </a><br>

        </div>
    </div>

    <script>

        function startCKEdit() {

            $('.start_editor_button')
                    .toggleClass('btn-info btn-success');


        }

    </script>









    {#            <script>#}
    {##}
    {#                // Turn off automatic editor creation first.#}
    {#                CKEDITOR.disableAutoInline = true;#}
    {#                CKEDITOR.inline('editor1', {#}
    {#                    toolbar: [#}
    {#                        {'name': 'clipboard', 'items': ['Undo', 'Redo', 'Cut', 'Copy', 'Paste']},#}
    {#                        {'name': 'styles', 'items': ['Font', 'FontSize']},#}
    {#                        {'name': 'basicstyles', 'items': ['Bold', 'Italic', 'Underline', 'Strike', '-', 'TextColor', 'BGColor']},#}
    {#                        {'name': 'paragraph', 'items': ['JustifyLeft', 'JustifyCenter', 'JustifyRight', '-', 'NumberedList', 'BulletedList', ]},#}
    {#                        {'name': 'insert', 'items': ['Image', 'Smiley']#}
    {#                        },#}
    {#                        {'name': 'editing', 'items': ['SelectAll', 'Find']}#}
    {#                    ],#}
    {#                    contentsCss: '/static/ckeditor/ckeditor/contents.css',#}
    {#                    disableNativeSpellChecker: false,#}
    {#                    height: 600,#}
    {#                    tabSpaces: 4,#}
    {#                    extraPlugins: 'colorbutton'#}
    {#                });#}
    {##}
{#                </script>#}

{% endblock %}

